<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="kaizeiの日常"><title>改用hexo了! | kaizeiとyimi</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/3.0.3/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="/blog/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="/blog/css/highlight.css?v=0.0.0"><script type="text/javascript" src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script><link rel="shortcut icon" href="/blog/favicon.ico"><link rel="apple-touch-icon" href="/blog/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/blog/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/blog/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">改用hexo了!</h1><a id="logo" href="/blog/.">kaizeiとyimi</a><p class="description">kaizeiの日常</p></div><div id="nav-menu"><a href="/blog/." class="current"><i class="fa fa-home"> </i><span>首页</span></a><a href="/blog/archives/"><i class="fa fa-archive"> </i><span>归档</span></a><a href="/blog/about/"><i class="fa fa-user"> </i><span>关于</span></a><a href="/blog/atom.xml"><i class="fa fa-rss"> </i><span>订阅</span></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">改用hexo了!</h1><div class="post-meta">Apr 13, 2016<span> | </span><span class="category"><a href="/blog/categories/技术/">技术</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><p>思量再三, 还是不用jekyll了. Ruby什么的累觉不爱, 最关键的是我刚装上最新版就直接不能启动... </p>
<p>什么? <span style="color:rgb(179,62,170)"><strong>没有给空定义match方法</strong></span>. 喂, 还能再详细点儿么? 让我怎么排查问题?</p>
<p>正好听朋友说<strong>hexo</strong>, 去䁖了一眼, 用Node做的. 文档真的是...(省略吐槽无数). 擦擦嘴, 喝口水. 其实做得挺不错的, 除了默认主题有点儿丑外加文档很烂以外. </p>
<a id="more"></a>
<p>折腾了几天, 基于一个主题<a href="https://github.com/pagecho/maupassant" target="_blank" rel="external">maupassant</a>进行了不少修改, 删除了大量我不需要的功能, 然后大改css, markdown解析以及高亮. 最后除了页面结构差不多, 其他的都差很多.</p>
<p>我这也算是自己弄了个主题? </p>
<p>我觉得hexo不错也许是因为我没有发现jekyll好用. 反正我暂时不会用jekyll了. 刚开始down下来默认模板的时候, 看了一下package, 带了一些category, tag之类的生成器, 一个markdown解析器用的marked, 然后还有个sass解析器的样子. 高亮是用的<strong>highlight.js</strong>, 这个已经被hexo内置了.</p>
<h2 id="其实我还是要吐槽的"><a href="#其实我还是要吐槽的" class="headerlink" title="其实我还是要吐槽的!!"></a>其实我还是要吐槽的!!</h2><p>不过槽点并不是很多, 嗯.</p>
<h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><p>其实我很喜欢<code>gulp</code>的想法. 扔掉键值对的配置文件, 直接用代码来配置. hexo完全基于Node, 所以为什么不直接用代码来配置? 讲真, 翻看源码的时候看到了一个用代码写好的default config的Object, hexo的逻辑是先加载default config, 然后加载我们的yml写的config文件去覆盖. 真的, 让我们直接写js吧, 最后吐出一个Object就行了, 这样就能完美解决插件配置的问题.</p>
<h3 id="marked"><a href="#marked" class="headerlink" title="marked"></a>marked</h3><p>首先是markdown解析. 好吧, 本来用marked挺好, 可是呢, marked需要配置啊, 默认的行为当然不是我想要的, 我需要修改它对head, table, code等的解析. 但是这些修改需要修改renderer的方法, 很显然, 这需要code. marked插件的源码我也读了一下, 它会去config对象上获取非常简单的能够用键值对配置的信息, 对于修改renderer无能为力. 因为hexo的做法直接屏蔽了这种可能性.</p>
<p>于是, 我自己写了插件... sigh. 没有做成npm包的形式, 而是直接在<code>scripts</code>文件夹里面写了一个简单的js. hexo说这里的脚本会在hexo启动的时候执行.</p>
<h3 id="highlight-js"><a href="#highlight-js" class="headerlink" title="highlight.js"></a>highlight.js</h3><p>真是欲哭无泪, 没有你这么内置的!! 我都只能用非常规手段去require人家原始的包了. hexo内置后, 也只能配置非常少的高亮信息, 对于需要代码配置的仍然只能干瞪眼. 于是, 我禁掉了配置文件里面的高亮, 在我的简单的小脚本里面(是的, 还是那里)在marked解析code时就把高亮了一起解析了. 于是, 页面终于能够正常处理markdown了.</p>
<h3 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h3><p>我... 提起这个我无语凝噎. 这缓存做得, 真是绝了. 反正我又写了个小脚本在hexo要处理文件的时候删这个缓存, 这次没有放在主题里面而是放在hexo主目录里面, 因为我觉得有一天应该会处理掉这个问题, 这个小脚本不应该是主题的一部分.</p>
<p>当时是这样的. 写了一点儿内容, 改了点儿css的我兴冲冲地调用了一把<code>hexo s -l</code>. oh, yeah! 页面! 然后我又改了一点儿内容, 刷新. 刷新? 刷新??? 为毛线没有变呢? 看日志是有请求的. 于是我重新启动了server, 还是没变!! 什么情况, 不明真相的我看了看文档, 说有缓存, 删掉试试? 然后就好了. 过了一会儿我再改, 又不给力了. 真的是很无奈, 我并没觉得那个缓存有什么帮助, 删! </p>
<h2 id="休息一下-吃根香蕉"><a href="#休息一下-吃根香蕉" class="headerlink" title="休息一下, 吃根香蕉"></a>休息一下, 吃根香蕉</h2><p>hexo是个Node的程序, 那就意味着Node的辣么多包都是可以搞起的, 虽然我不会. 看起来hexo的架构设计得还不错, 没有仔细研究, 它大概是把事情分成了好几部, 处理文件, 渲染post, 生成各个页面等, 还有filter神马的没仔细看. 每个步骤都可以充分发挥你的想象去做事情, 只要符合规范就好. 而且它可以很好地发挥Node的异步特性, 让页面并行生成.</p>
<p>目前我的模板是用的jade, css用的scss来写, post当然是markdown啦.</p>
<p>我的侧边栏和原版的不一样哦, 不会滚出屏幕哦, 不会看到文章后边的时候觉得页面空空的, 也不是单纯的吸顶, 要考虑内容长过窗口高度的情况. 反正是费了点儿功夫, 代码很简单, 也已经把这个做成了一个可开关的功能.</p>
<p>分享的那个小弹窗觉得原版做得不合理, 于是也改了一下, 布局方式改了, 并且把里面的项目做成了可配置. 其他还有不少改动主要是改进一下布局方式和删了不少代码.</p>
<h2 id="总之"><a href="#总之" class="headerlink" title="总之"></a>总之</h2><p>我觉得一定是我没有弄明白人家的牛逼之处, 还吐这么多槽, 笨死了🙁.</p>
<p>其实不就是个静态博客系统么?! 可是折腾的天性加上Node让我很很看好hexo, 是不是<strong>github page</strong>也支持一下hexo? 哈哈, 这样我就不用每次都要先generate再提交了. 大家也来用一下哇~</p>
</div><div class="article-share"><script type="text/javascript" src="/blog/js/share.js?v=0.0.0" async></script><a data-url="" data-id="ciofxq6cc000zz1pgekvlyd8c" class="article-share-link">分享</a><div class="article-share-box"><div class="article-share-links"><a target="_blank" title="Twitter" class="article-share-twitter"></a><a target="_blank" title="Facebook" class="article-share-facebook"></a><a target="_blank" title="Sina Weibo" class="article-share-sinaweibo"></a><a target="_blank" title="Wechat" class="article-share-wechat"></a></div></div></div><div class="tags"><a href="/blog/tags/JS/">JS</a></div><div class="post-nav"><a href="/blog/2016/04/17/make-AutoLayout-X/" class="pre">make AutoLayout X</a><a href="/blog/2016/04/13/swift-AnyObject-little-tips/" class="next">swift AnyObject little tips</a></div></div></div></div><div class="pure-u-1-4"><div id="sidebar-placeholder"> </div><div id="sidebar-container"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Google"/><input type="hidden" name="sitesearch"/><script>var input=document.getElementsByName('sitesearch')[0];if(input){input.setAttribute('value', window.location.host);}</script></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/技术/">技术</a></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/日常/">日常</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/blog/tags/iOS/" style="font-size: 15px;">iOS</a> <a href="/blog/tags/XCode/" style="font-size: 15px;">XCode</a> <a href="/blog/tags/Github/" style="font-size: 15px;">Github</a> <a href="/blog/tags/年终总结/" style="font-size: 15px;">年终总结</a> <a href="/blog/tags/swift/" style="font-size: 15px;">swift</a> <a href="/blog/tags/NativeScript/" style="font-size: 15px;">NativeScript</a> <a href="/blog/tags/JS/" style="font-size: 15px;">JS</a> <a href="/blog/tags/cocoapods/" style="font-size: 15px;">cocoapods</a> <a href="/blog/tags/workspace/" style="font-size: 15px;">workspace</a> <a href="/blog/tags/心情/" style="font-size: 15px;">心情</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/blog/2016/05/26/break-swift-init-rule/">对swift中单例的init搞破坏</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2016/05/20/the-Twenty-of-May/">the Twenty of May</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2016/05/19/reuse-internal-codes/">复用内部公用代码的几种方式</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2016/04/17/make-AutoLayout-X/">make AutoLayout X</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2016/04/13/改用hexo了/">改用hexo了!</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2016/04/13/swift-AnyObject-little-tips/">swift AnyObject little tips</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2016/04/11/nativescript/">集成NativeScript iOSRuntime到已有工程</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2016/03/28/swift_type_convert/">swift 2.2 类型转换小坑</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2016/03/15/年后小总结/">2016 年后小总结</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2014/12/08/XLYAutoLayoutEasy/">XLYAutoLayoutEasy</a></li></ul></div></div><script type="text/javascript" src="/blog/js/sidebar.js?v=0.0.0"></script></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/blog/." rel="nofollow">kaizei.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div></div></body></html>